<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="initial-scale=1, width=device-width" />
    <title>Milk</title>
    <link rel="stylesheet" href="./milk.css" />
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css2?family=ABeeZee:ital,wght@0,400;1,400&display=swap"
    />
</head>
<body>
    <div class="milk">Milk</div>
    <div class="center-container">
        <div class="product-card" data-product-id="672bc64619505e01a8e6e3b5"> <!-- Add your unique product ID here -->
            <img class="image-icon" alt="" src="./images/milk.png" />

            <i class="tide">Fresh Milk</i>
            <i class="you-can-also">You can also like this</i>
            <i class="i">Rs30</i>

            <div class="tide-ultra-oxi">
                Milk is an excellent source of vitamins and minerals, particularly calcium.
                It has an important role in bone health. Nutritionists recommend that people
                have milk and other dairy products, such as yoghurt and cheese, every day as
                part of a balanced diet. Consuming milk and milk products are linked to improved bone health,
                especially in children and adolescents. Consuming milk and milk products may also help
                to reduce the risk of cardiovascular disease.
            </div>
            <div class="shipping-info">Shipping info</div>
            <div class="support">Support</div>
            <div class="item-details">Item details</div>
            <div class="line"></div>
            <div class="line1"></div>
            <div class="line2"></div>
            <div class="line3"></div>

            <div class="product-cardsalemain" id="productCardSaleMainContainer">
                <button onclick="window.location.href='productcard.html'"><img class="photo-icon" alt="" src="./images/tide.png" /></button>
                <i class="item">Fabric Softener</i>
            </div>
            <div class="product-cardnewmain">
                <button onclick="window.location.href='productenergy.html'"><img class="photo-icon" alt="" src="./images/energy.png" /></button>
                <i class="item">Monster Energy</i>
            </div>

            <i class="item"> </i>
        </div>
        <div class="group">
            <div class="button-container">
                <button onclick="addToCart()" class="add-to-cart">ADD TO CART</button>
                <button class="ar-navigation">AR NAVIGATION</button>
            </div>
        </div>

        <script>
            async function addToCart(quantity = 1) {
                const productCard = document.querySelector('.product-card');
                const productId = productCard.getAttribute('data-product-id'); // Get the product ID from the data attribute
                const access_token = localStorage.getItem('token'); // Assuming you store the JWT token in local storage

                // Check if the access token exists
                if (!access_token) {
                    alert('You need to log in first.'); // Alert the user if no token is found
                    return; // Exit the function if no token is found
                }

                const response = await fetch('http://localhost:5000/cart/cart', { // Sending data to backend
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${access_token}`
                    },
                    body: JSON.stringify({
                        item_id: '672bc64619505e01a8e6e3b5', // Use the product ID here
                        quantity: quantity
                    })
                });

                if (response.ok) {
                    alert('Item added to cart successfully!');
                    window.location.href = 'mybag.html'; // Redirect to "my bag" page
                } else {
                    const errorData = await response.json();
                    alert(`Error: ${errorData.msg}`);
                }
            }
        </script>
    </div>
</body>
</html>