<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="initial-scale=1, width=device-width" />
    <title>Moisturising Cream</title>
    <link rel="stylesheet" href="./cream.css" />
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css2?family=ABeeZee:ital,wght@0,400;1,400&display=swap"
    />
</head>
<body>
    <div class="cream">Moisturising Cream</div>
    <div class="center-container">
        <div class="product-card" data-product-id="672bc64619505e01a8e6e3b6"> <!-- Add your unique product ID here -->
            <img class="image-icon" alt="" src="./images/cream.png" />

            <i class="tide">Moisturising Cream</i>
            <i class="you-can-also">You can also like this</i>
            <i class="i">Rs200</i>

            <div class="tide-ultra-oxi">
                Himalaya Intensive Moisturizing Cream moisturizes even the extremely dry areas of your skin.
                Wheatgerm, a rich natural source of vitamin E, provides nourishment to keep the skin soft and
                supple and protects it from environmental damage. Almonds moisturize even the extremely dry
                areas of the skin. With its marked humectant properties, Intensive Moisturizing Cream plays
                a softening and moisturizing action, thus promoting the transfer of water molecules to the skin cells.
            </div>
            <div class="shipping-info">Shipping info</div>
            <div class="support">Support</div>
            <div class="item-details">Item details</div>
            <div class="line"></div>
            <div class="line1"></div>
            <div class="line2"></div>
            <div class="line3"></div>

            <div class="product-cardsalemain" id="productCardSaleMainContainer">
                <button onclick="window.location.href='productcard.html'"><img class="photo-icon" alt="" src="./images/tide.png" /></button>
                <i class="item">Fabric Softener</i>
            </div>
            <div class="product-cardnewmain">
                <button onclick="window.location.href='productenergy.html'"><img class="photo-icon" alt="" src="./images/energy.png" /></button>
                <i class="item">Monster Energy</i>
            </div>

            <i class="item"> </i>
        </div>
        <div class="group">
            <div class="button-container">
                <button onclick="addToCart()" class="add-to-cart">ADD TO CART</button>
                <button class="ar-navigation">AR NAVIGATION</button>
            </div>
        </div>

        <script>
            async function addToCart(quantity = 1) {
                const productCard = document.querySelector('.product-card');
                const productId = productCard.getAttribute('data-product-id'); // Get the product ID from the data attribute
                const access_token = localStorage.getItem('token'); // Assuming you store the JWT token in local storage

                // Check if the access token exists
                if (!access_token) {
                    alert('You need to log in first.'); // Alert the user if no token is found
                    return; // Exit the function if no token is found
                }

                const response = await fetch('http://localhost:5000/cart/cart', { // Sending data to backend
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${access_token}`
                    },
                    body: JSON.stringify({
                        item_id: '672bc64619505e01a8e6e3b6', // Use the product ID here
                        quantity: quantity
                    })
                });

                if (response.ok) {
                    alert('Item added to cart successfully!');
                    window.location.href = 'mybag.html'; // Redirect to "my bag" page
                } else {
                    const errorData = await response.json();
                    alert(`Error: ${errorData.msg}`);
                }
            }
        </script>
    </div>
</body>
</html>